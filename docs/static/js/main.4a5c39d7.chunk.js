(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,n){e.exports=n(68)},38:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(15),i=n(12),o=n(0),r=n.n(o),s=n(28),c=n.n(s),l=(n(38),n(2)),u=n(6),d=n(4),p=n(3),m=n(5),h=n(20),f=n(11),E=function(){return window.innerWidth<767},v=function(e,t,n){return(Array.isArray(e)?e:[e]).map(function(e){var a="boolean"===typeof n?n:e.classList.contains(t);return a?e.classList.remove(t):e.classList.add(t),!a})};var O=new(n(29).Dispatcher),b={GET_POSTS:"GET_POSTS",MORE_POSTS:"MORE_POSTS",NEW_POST:"NEW_POST",DELETE_POST:"DELETE_POST",LIKE:"LIKE",THEME_CHANGE:"THEME_CHANGE",LOADING:function(e){return"LOADING_".concat(e)}},k=function(){return O.dispatch({type:b.THEME_CHANGE})},_=n(10),y=new _.EventEmitter;var g=y;O.register(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type;switch(e.payload,t){case b.THEME_CHANGE:y.emit(t)}});var S=function(e){return O.dispatch({type:b.LIKE,payload:e})},P=function(e){return O.dispatch({type:b.NEW_POST,payload:e})},T=function(e){return O.dispatch({type:b.DELETE_POST,payload:e})},j=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i))))._btn=r.a.createRef(),n.state={dark:!1},n._click=function(){var e=n._btn.current,t=Object(h.a)(e.children,2),a=t[0],i=t[1],o=v([a,i],"active"),r=Object(h.a)(o,1)[0];n.setState({dark:r}),n._changeTheme(r),window.localStorage.setItem("DARK_THEME",r)},n.newPost=function(){var e=prompt("Digite a URL");P(e)},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;g.on(b.THEME_CHANGE,function(){return e._click()})}},{key:"_changeTheme",value:function(e){var t=Array.from(document.body.querySelectorAll("*:not(script)"));v(t,"dark",!e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"add",onClick:this.newPost},"Add News +"),r.a.createElement("div",{className:"theme-btn",onClick:k},r.a.createElement("div",{className:"button",ref:this._btn},r.a.createElement("div",{className:"text"},this.state.dark?"DARK":"LIGHT"),r.a.createElement("div",{className:"ball"}))))}}]),t}(r.a.Component),N=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"header"},r.a.createElement(j,null),r.a.createElement("div",{className:"heading"},r.a.createElement("h3",{className:"news"},"NEWS"),r.a.createElement("div",{className:"line"})))}}]),t}(r.a.Component),w=n(16),L=n.n(w),M=n(18),A=n(9),D=n(19),I=n.n(D),G={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},R=I.a.create({baseURL:"http://localhost:3001/",headers:G}),C=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error(t),alert("Houve algum erro")},H=new(function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this)))._newPost=function(){var t=Object(M.a)(L.a.mark(function t(n){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.emit(b.LOADING(b.NEW_POST),!0),t.next=3,e.getMetaData(n);case 3:a=t.sent,console.log(a),R.post("posts",a).then(function(t){console.log(t),e.getPosts()}).catch(C).finally(function(){e.emit(b.LOADING(b.NEW_POST),!1)});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e._deletePost=function(){var t=Object(M.a)(L.a.mark(function t(n){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.emit(b.LOADING(b.DELETE_POST),!0),R.delete("posts/".concat(n)).then(function(){e.getPosts()}).catch(C).finally(function(){e.emit(b.LOADING(b.DELETE_POST),!1)});case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.checkIfLiked=function(t){return e.likedPosts.includes(t)},e.handleActions=function(t){var n=t.type,a=t.payload;switch(console.log("action",{type:n,payload:a}),n){case b.LIKE:e.like(a.id);break;case b.NEW_POST:e._newPost(a);break;case b.DELETE_POST:e._deletePost(a.id)}},e.data={posts:[],top5:[]},e.likedPosts=JSON.parse(window.localStorage.getItem("LIKED_POSTS"))||[],e.limit=0,console.log(Object(A.a)(e)),e}return Object(m.a)(t,e),Object(u.a)(t,[{key:"getMetaData",value:function(e){return I.a.get("https://cors-anywhere.herokuapp.com/".concat(e),{headers:G}).then(function(t){var n=t.data,a=document.createElement("html");a.innerHTML=n;var i,o={link:e};return Array.from(a.querySelectorAll("meta")).map(function(e){var t=e.content;return{name:e.getAttribute("property"),content:t}}).filter(function(e){return e.name&&e.name.match(/og:.+/)}).map(function(e){var t=e.name.replace("og:","");return o[t]=e.content}),{title:(i=o).title,description:i.description,site_name:i.site_name||"N\xe3o Fornecido",image:i.image,link:i.link}}).catch(C)}},{key:"getMorePosts",value:function(){var e=this;return this.emit(b.LOADING(b.MORE_POSTS),!0),R.get("posts?limit=".concat(++this.limit)).then(function(t){return console.log("Recebendo mais posts...",t.data.posts),e.data.posts=[].concat(Object(f.a)(e.data.posts),Object(f.a)(t.data.posts)),e.emit(b.MORE_POSTS,e.data),t}).catch(C).finally(function(){e.emit(b.LOADING(b.MORE_POSTS),!1)})}},{key:"getPosts",value:function(){var e=this;return this.emit(b.LOADING(b.GET_POSTS),!0),R.get("posts").then(function(t){e.data=t.data,e.emit(b.GET_POSTS,e.data)}).catch(C).finally(function(){e.emit(b.LOADING(b.GET_POSTS),!1)}),this.data.posts}},{key:"like",value:function(e){var t=this;this.checkIfLiked(e)?(this.likedPosts=this.likedPosts.filter(function(t){return t!==e}),R.delete("like/".concat(e)).then(function(e){var n=e.data;return t._replacePost(n)}).catch(C)):(R.get("like/".concat(e)).then(function(e){var n=e.data;return t._replacePost(n)}).catch(C),this.likedPosts.push(e)),window.localStorage.setItem("LIKED_POSTS",JSON.stringify(this.likedPosts))}},{key:"_replacePost",value:function(e){this.data.posts=this.data.posts.map(function(t){return e.id===t.id?e:t}),this.emit(b.GET_POSTS,this.data)}}]),t}(_.EventEmitter));O.register(H.handleActions);var W=n(8),z=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i))))._like=function(e){e.preventDefault(),e.stopPropagation(),n.props.onLike()},n._delete=function(e){e.preventDefault(),e.stopPropagation(),n.props.onDelete()},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=H.checkIfLiked(this.props.post.id)?"liked":"",t={backgroundImage:"url('".concat(this.props.post.image||"https://via.placeholder.com/320","')")};return r.a.createElement("div",{className:"img",hidden:this.props.hidden,style:t},r.a.createElement("div",{className:"likes delete",hidden:this.props.simple,onClick:this._delete},r.a.createElement("div",{className:"icon"},r.a.createElement(W.a,{icon:"trash-alt"}))),r.a.createElement("div",{className:"likes ".concat(e," like"),hidden:this.props.simple,onClick:this._like},r.a.createElement("div",{className:"icon"},r.a.createElement(W.a,{icon:"heart"})),r.a.createElement("div",{className:"count"},r.a.createElement("b",null,this.props.post.count))))}}]),t}(r.a.Component),K=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).click=function(){window.open(n.props.data.link)},n._like=function(){return S(n.props.data)},n._delete=function(){return T(n.props.data)},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=!!this.props.simple,t=e?"simple":"",n=this.props.mobile&&e;return r.a.createElement("div",{className:"post ".concat(t),onClick:this.click,"post-id":this.props.data.id},r.a.createElement(z,{onLike:this._like,onDelete:this._delete,post:this.props.data,simple:e}),r.a.createElement("div",{className:"body"},r.a.createElement("h4",{className:"header",hidden:n},this.props.data.title),r.a.createElement("p",{className:"description"},this.props.data.description),r.a.createElement("div",{className:"footer"},r.a.createElement("div",{hidden:n||e},r.a.createElement(W.a,{icon:"globe"}),r.a.createElement("span",null,this.props.data.site_name)),r.a.createElement("div",{hidden:e&&!n},r.a.createElement(W.a,{icon:"clock"}),r.a.createElement("span",null,function(e){var t=((new Date).getTime()-e.getTime())/1e3/60/60;return t<1?Math.round(60*t)+" mins ago":Math.round(t)+" hours ago"}(new Date(this.props.data.date)))))))}}]),t}(r.a.Component),x=n(30),q=n.n(x),J=new(function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this))).onResize=function(t){return e.on("resize",t)},e.offResize=function(t){return e.off("resize",t)},e.isMobile=E(),window.addEventListener("resize",function(){e.isMobile=E(),e.emit("resize",e.isMobile)}),console.log(Object(A.a)(e)),e}return Object(m.a)(t,e),t}(_.EventEmitter)),U=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"loading",hidden:this.props.hidden},r.a.createElement(W.a,{icon:"sync-alt"}))}}]),t}(r.a.Component),X={slideBy:"page",mouseDrag:!0,controls:!1,nav:!0,loop:!1},B=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).ts=r.a.createRef(),n.morePostsLock=!1,n.state={mobile:J.isMobile,loading:!1},n._onResize=function(e){return n.setState({mobile:e})},n._checkSliderMorePosts=function(){var e=n.ts.current.slider.getInfo(),t=e.navCurrentIndex,a=e.slideCount;t>=a-1&&H.getMorePosts().then(function(){n.ts.current.slider.goTo(t)})},n._onScroll=function(e){return function(){window.scrollY+window.outerHeight+e>=document.body.scrollHeight&&!n.morePostsLock&&!n.state.mobile&&(console.log("More posts..."),n.morePostsLock=!0,H.getMorePosts())}},n._infiniteScrollListen(),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;H.on(b.LOADING(b.MORE_POSTS),function(t){e.setState({loading:t})}),J.onResize(this._onResize)}},{key:"componentWillUnmount",value:function(){J.onResize(this._onResize)}},{key:"_infiniteScrollListen",value:function(){var e=this._onScroll(900),t=function(e,t,n){var a;return function(){var i=this,o=arguments,r=n&&!a;clearTimeout(a),a=setTimeout(function(){a=null,n||e.apply(i,o)},t),r&&e.apply(i,o)}}(e,100);window.addEventListener("scroll",t),J.onResize(function(e){e||window.removeEventListener("scroll",t)})}},{key:"render",value:function(){var e=this,t=this.props.posts.map(function(t){return r.a.createElement(K,{mobile:e.state.mobile,key:t.id,data:t})}),n=this.state.mobile?this._renderMobile(t):t;return r.a.createElement("div",null,r.a.createElement("div",{className:"posts ".concat(this.state.mobile?"mobile":"")},n),r.a.createElement(U,{hidden:!this.state.loading}))}},{key:"_renderMobile",value:function(e){return r.a.createElement(q.a,{onTransitionStart:this._checkSliderMorePosts,settings:X,ref:this.ts},e)}}]),t}(r.a.Component),F=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"sidebar"},this.props.posts.map(function(e){return r.a.createElement(K,{simple:!0,key:e.id,data:e})}))}}]),t}(r.a.Component),Y=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).state={loading:!0,posts:H.getPosts(),top5:[]},n._updatePosts=function(e){var t=e.posts,a=e.top5;n.setState({posts:t,top5:a,loading:!1})},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;H.on(b.GET_POSTS,this._updatePosts),H.on(b.MORE_POSTS,this._updatePosts),H.on(b.LOADING(b.NEW_POST),function(t){return e.setState({loading:t})})}},{key:"componentWillUnmount",value:function(){H.off(b.GET_POSTS,this._updatePosts),H.off(b.MORE_POSTS,this._updatePosts)}},{key:"componentDidMount",value:function(){"true"===window.localStorage.getItem("DARK_THEME")&&k()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"main"},r.a.createElement(N,null),r.a.createElement(U,{hidden:!this.state.loading}),r.a.createElement(B,{posts:this.state.posts})),r.a.createElement(F,{posts:this.state.top5})))}}]),t}(o.Component);a.b.add(i.c,i.e,i.b,i.a,i.d),c.a.render(r.a.createElement(Y,null),document.querySelector("#root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.4a5c39d7.chunk.js.map